<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>$UDI</title>

  <link rel="icon" href="UDifavicon.png" />
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet"/>

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fd8c02;
      color: white;
      font-family: 'Special Elite', monospace;
      overflow-x: hidden;
    }

    .check-container {
      width: 100%;
      max-width: 380px;
      padding: 0 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      z-index: 2;
    }

    .logo {
      width: 850px;
      max-width: 100%;
      margin-bottom: 16px;
    }

    .mint-btn {
      width: 100%;
      padding: 16px 0;
      border-radius: 12px;
      border: 2px solid white;
      background: transparent;
      color: white;
      font-size: 1.4rem;
      letter-spacing: 4px;
      font-weight: bold;
      cursor: pointer;
      font-family: 'Special Elite', monospace;
      animation: blink 1.8s infinite ease-in-out, shake 3s infinite;
    }

    @keyframes blink {
      0%,100%{opacity:1}50%{opacity:.6}
    }

    @keyframes shake {
      0%{transform:translateX(0)}
      2%{transform:translateX(-1px)}
      4%{transform:translateX(1px)}
      6%{transform:translateX(-1px)}
      8%{transform:translateX(1px)}
      10%{transform:translateX(0)}
      100%{transform:translateX(0)}
    }

    .option-box {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      width: 260px;
      height: 340px;
      background: rgba(0,0,0,.25);
      backdrop-filter: blur(6px);
      border: 2px solid white;
      border-radius: 16px;
      transition: .4s ease;
      cursor: pointer;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .option-left { left: -220px; }
    .option-left.active { left: 20px; }

    .option-right { right: -220px; }
    .option-right.active { right: 20px; }

    .arrow { font-size: 2.5rem; opacity: .35; }
    .option-box.active .arrow { display: none; }

    .option-content {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      width: 100%;
      height: 100%;
      justify-content: center;
      padding: 12px;
    }

    .option-box.active .option-content { display: flex; }

    .option-content img {
      width: 140px;
      height: 140px;
      border-radius: 12px;
      border: 2px dashed rgba(255,255,255,.5);
    }

    .option-text { font-size: .9rem; letter-spacing: 1px; }

    .percent { font-size: .8rem; opacity: .8; }

    .locked { opacity: .25; pointer-events: none; }

    /* CONFIRM MODAL */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .modal-box {
      background: black;
      border: 2px solid white;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      width: 280px;
    }

    .modal-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 16px;
    }

    .modal-buttons button {
      width: 48%;
      padding: 8px 0;
      border-radius: 8px;
      border: 1px solid white;
      background: transparent;
      color: white;
      cursor: pointer;
      font-family: inherit;
    }
  </style>
</head>

<body>
  <div class="option-box option-left" id="leftBox" onclick="openConfirm('LEFT')">
    <div class="arrow">◀</div>
    <div class="option-content">
      <img src="" />
      <div class="option-text">LEFT OPTION</div>
      <div class="percent" id="leftPercent">0%</div>
    </div>
  </div>

  <div class="option-box option-right" id="rightBox" onclick="openConfirm('RIGHT')">
    <div class="arrow">▶</div>
    <div class="option-content">
      <img src="" />
      <div class="option-text">RIGHT OPTION</div>
      <div class="percent" id="rightPercent">0%</div>
    </div>
  </div>

  <div class="check-container">
    <img src="Smoke.gif" class="logo" />
    <button class="mint-btn" onclick="window.open('https://opensea.io/collection/udion')">MINT</button>
  </div>

  <!-- CONFIRM MODAL -->
  <div class="modal" id="confirmModal">
    <div class="modal-box">
      <div>Are you sure?</div>
      <div style="font-size:.8rem;opacity:.7;margin-top:6px">
        This choice cannot be changed.
      </div>
      <div class="modal-buttons">
        <button onclick="confirmVote()">YES</button>
        <button onclick="closeConfirm()">NO</button>
      </div>
    </div>
  </div>

  <script>
    let selectedSide = null;

    let votes = JSON.parse(localStorage.getItem("votes")) || { LEFT: 0, RIGHT: 0 };
    let userVote = localStorage.getItem("userVote");

    function updatePercent() {
      const total = votes.LEFT + votes.RIGHT || 1;
      document.getElementById("leftPercent").innerText =
        Math.round((votes.LEFT / total) * 100) + "%";
      document.getElementById("rightPercent").innerText =
        Math.round((votes.RIGHT / total) * 100) + "%";
    }

    function openConfirm(side) {
      if (userVote) return alert("You already voted.");
      selectedSide = side;
      document.getElementById("confirmModal").style.display = "flex";
    }

    function closeConfirm() {
      selectedSide = null;
      document.getElementById("confirmModal").style.display = "none";
    }

    function confirmVote() {
      if (!selectedSide) return;
      votes[selectedSide]++;
      userVote = selectedSide;

      localStorage.setItem("votes", JSON.stringify(votes));
      localStorage.setItem("userVote", userVote);

      document.getElementById("confirmModal").style.display = "none";
      lockOptions();
      updatePercent();
    }

    function lockOptions() {
      if (userVote === "LEFT") {
        document.getElementById("rightBox").classList.add("locked");
        document.getElementById("leftBox").classList.add("active");
      } else if (userVote === "RIGHT") {
        document.getElementById("leftBox").classList.add("locked");
        document.getElementById("rightBox").classList.add("active");
      }
    }

    function checkWalletEligibility() {
      // TODO: Sau này nối ví + check trait ở đây
      return true;
    }

    updatePercent();
    if (userVote) lockOptions();
  </script>
</body>
</html>

